<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: ISDB: setting up a Metadynamics Metainference simulation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.8.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('isdb-1.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ISDB: setting up a Metadynamics Metainference simulation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="isdb-1-aims"></a>
Aims</h1>
<p>The aim of this tutorial is to introduce the users to the ISDB module and in particular to Metadynamics Metainference <a class="el" href="citelist.html#CITEREF_Bonomi:2016ip">[18]</a> <a class="el" href="citelist.html#CITEREF_Bonomi:2016ge">[19]</a> ensemble determination. We will reproduce the setup of the simulation for a simple system <a class="el" href="citelist.html#CITEREF_Lohr:2017gc">[74]</a> . For a general overview of the problem of ensembles determination please read <a class="el" href="citelist.html#CITEREF_Bonomi:2017dn">[20]</a> .</p>
<h1><a class="anchor" id="isdb-1-objectives"></a>
Objectives</h1>
<p>Once this tutorial is completed students will be able to:</p>
<ul>
<li>Setup their own PLUMED-ISDB simulation.</li>
</ul>
<h1><a class="anchor" id="isdb-1-resources"></a>
Resources</h1>
<p>The <span style="background-color:yellow"><a href="tutorial-resources/isdb-1.tar.gz" style="font-weight:bold" style="color:green" download="isdb-1.tar.gz">TARBALL</a> </span> for this project contains the following files:</p><ul>
<li>charmm36-eef1sb.ff: the force-field files for gromacs (not needed)</li>
<li>system: a folder with reference files for gromacs (not needed)</li>
<li>reference-impl: a folder to perform a simple implicit solvent simulation</li>
<li>reference-impl-pbmetad: a folder to perform a pbmetad implicit solvent simulation</li>
<li>m_and_m: a folder to perform a metadynamics metainference simulation</li>
</ul>
<h1><a class="anchor" id="isdb-1-intro"></a>
Introduction</h1>
<p>Molecular dynamics simulations are the ideal tool to determine at atomistic resolution the behavior of complex molecules. This great resolution power comes at the cost of approximations that affects the agreement with actual experimental observables. At the same time experimental data alone are generally speaking not enough to determine a structural ensemble due the inverse nature of the problem, that is to go from few observables to many atoms in many different configurations. Furthermore, experimental data are affected by errors of multiple nature, from noise, systematic errors and errors in their atomistic interpretation. Most important experimental data are the result of the averaging over the ensemble of structure so it is not trivial to deconvolve this signal. One possibility is that of employing MD simulations together with experimental data to generate simulations already corrected for the data themselves. With <a class="el" href="_m_e_t_a_i_n_f_e_r_e_n_c_e.html">METAINFERENCE</a> this is done on-the-fly by adding an additional energy to the system that takes into account the agreement with the experimental data considering the multiple sources of errors.</p>
<h1><a class="anchor" id="isdb-1-reference"></a>
Run a reference simulation</h1>
<p>The system we use is the EGAAWAASS peptide used in ref. <a class="el" href="citelist.html#CITEREF_Lohr:2017gc">[74]</a> . First of all we will run a simulation in implicit solvent using the EEF1-SB CHARMM36 force field. EEF1-SB includes a correction to the standard backbone torsion potential of CHARMM36, an electrostatic interaction with a distance dependent dielectric constant and a simple gaussian form for the solvation energy. The first two terms are implemented in the force field and using table potentials while the latter is implemented as a collective variable in PLUMED, <a class="el" href="_e_e_f_s_o_l_v.html">EEFSOLV</a> .</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># this is optional and tell to VIM that this is a PLUMED file</span>
<span style="color:blue"># vim: ft=plumed</span>
<span style="color:blue"># see comments just below this input file</span>
<span style="color:blue">#SETTINGS MOLFILE=user-doc/tutorials/others/isdb-1/reference-impl/egaawaass.pdb</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> <div class="tooltip">MOLTYPE<div class="right"><b>compulsory keyword ( default=protein )</b>
what kind of molecule is contained in the pdb file - usually not needed since protein/RNA/DNA
are compatible <i></i></div></div>=protein <div class="tooltip">STRUCTURE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing a reference structure. <i></i></div></div>=egaawaass.pdb <span style="display:none;" id="eg1">The MOLINFO action with label <b></b></span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html" style="color:green">WHOLEMOLECULES</a> <div class="tooltip">ENTITY0<div class="right">the atoms that make up a molecule that you wish to align. <i></i></div></div>=1-111 <span style="display:none;" id="eg1">The WHOLEMOLECULES action with label <b></b></span>
<span style="color:blue"># EEF1SB Implicit solvation</span>
<span style="color:blue">#SETTINGS AUXFILE=user-doc/tutorials/others/isdb-1/reference-impl/index.ndx</span>
<b name="eg1protein-h" onclick='showPath("eg1","eg1protein-h")'>protein-h: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_g_r_o_u_p.html" style="color:green">GROUP</a> <div class="tooltip">NDX_FILE<div class="right">the name of index file (gromacs syntax) <i></i></div></div>=index.ndx <div class="tooltip">NDX_GROUP<div class="right">the name of the group to be imported (gromacs syntax) - first group found is used
by default <i></i></div></div>=Protein-H <span style="display:none;" id="eg1protein-h">The GROUP action with label <b>protein-h</b> defines a group of atoms so that they can be referred to later in the input</span>
<b name="eg1solv" onclick='showPath("eg1","eg1solv")'>solv: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_e_e_f_s_o_l_v.html" style="color:green">EEFSOLV</a> <div class="tooltip">ATOMS<div class="right">The atoms to be included in the calculation, e.g. <i></i></div></div>=<b name="eg1protein-h">protein-h</b> <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <div class="tooltip">NL_STRIDE<div class="right"><b>compulsory keyword ( default=40 )</b>
The frequency with which the neighbor list is updated. <i></i></div></div>=20 <div class="tooltip">NL_BUFFER<div class="right"><b>compulsory keyword ( default=0.1 )</b>
The buffer to the intrinsic cutoff used when calculating pairwise interactions. <i></i></div></div>=0.1 <span style="display:none;" id="eg1solv">The EEFSOLV action with label <b>solv</b> calculates a single scalar value</span>
</pre>
bias: BIASVALUE ARG=solv<p>This can be run using gromacs (unfortunately recent versions of gromacs do not support Verlet groups with table potentials, so performances are currently sub-optimal on the gromacs side)</p>
<pre class="fragment">gmx_mpi mdrun -s run.tpr -table table.xvg -tablep table.xvg -plumed plumed-eef1.dat -v
</pre><p>In order to have a converged sampling for this reference ensemble calculation it is useful to setup a Metadynamics calculation. In particular we will use <a class="el" href="_p_b_m_e_t_a_d.html">PBMETAD</a> because it is then a natural choice for Metadynamics Metainference later.</p>

<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># this is optional and tell to VIM that this is a PLUMED file</span>
<span style="color:blue"># vim: ft=plumed</span>
<span style="color:blue"># see comments just below this input file</span>
<span style="color:blue">#SETTINGS MOLFILE=user-doc/tutorials/others/isdb-1/reference-impl/egaawaass.pdb</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> <div class="tooltip">MOLTYPE<div class="right"><b>compulsory keyword ( default=protein )</b>
what kind of molecule is contained in the pdb file - usually not needed since protein/RNA/DNA
are compatible <i></i></div></div>=protein <div class="tooltip">STRUCTURE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing a reference structure. <i></i></div></div>=egaawaass.pdb <span style="display:none;" id="eg2">The MOLINFO action with label <b></b></span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html" style="color:green">WHOLEMOLECULES</a> <div class="tooltip">ENTITY0<div class="right">the atoms that make up a molecule that you wish to align. <i></i></div></div>=1-111 <span style="display:none;" id="eg2">The WHOLEMOLECULES action with label <b></b></span>
<span style="color:blue"># EEF1SB Implicit solvation</span>
<span style="color:blue">#SETTINGS AUXFILE=user-doc/tutorials/others/isdb-1/reference-impl/index.ndx</span>
<b name="eg2protein-h" onclick='showPath("eg2","eg2protein-h")'>protein-h: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_g_r_o_u_p.html" style="color:green">GROUP</a> <div class="tooltip">NDX_FILE<div class="right">the name of index file (gromacs syntax) <i></i></div></div>=index.ndx <div class="tooltip">NDX_GROUP<div class="right">the name of the group to be imported (gromacs syntax) - first group found is used
by default <i></i></div></div>=Protein-H <span style="display:none;" id="eg2protein-h">The GROUP action with label <b>protein-h</b> defines a group of atoms so that they can be referred to later in the input</span>
<b name="eg2solv" onclick='showPath("eg2","eg2solv")'>solv: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_e_e_f_s_o_l_v.html" style="color:green">EEFSOLV</a> <div class="tooltip">ATOMS<div class="right">The atoms to be included in the calculation, e.g. <i></i></div></div>=<b name="eg2protein-h">protein-h</b> <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <div class="tooltip">NL_STRIDE<div class="right"><b>compulsory keyword ( default=40 )</b>
The frequency with which the neighbor list is updated. <i></i></div></div>=20 <div class="tooltip">NL_BUFFER<div class="right"><b>compulsory keyword ( default=0.1 )</b>
The buffer to the intrinsic cutoff used when calculating pairwise interactions. <i></i></div></div>=0.1 <span style="display:none;" id="eg2solv">The EEFSOLV action with label <b>solv</b> calculates a single scalar value</span>
<b name="eg2bias" onclick='showPath("eg2","eg2bias")'>bias: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_i_a_s_v_a_l_u_e.html" style="color:green">BIASVALUE</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg2solv">solv</b> <span style="display:none;" id="eg2bias">The BIASVALUE action with label <b>bias</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">bias.bias</td><td>the instantaneous value of the bias potential</td></tr><tr><td width="5%%">bias.solv_bias</td><td>one or multiple instances of this quantity can be referenced elsewhere in the input file. these quantities will named with  the arguments of the bias followed by the character string _bias. These quantities tell the user how much the bias is due to each of the colvars. This particular component measures this quantity for the input CV named solv</td></tr></table>
</span>
<span style="color:blue"># CVs, Psi9, Phi1 are not defined</span>
<b name="eg2psi1" onclick='showPath("eg2","eg2psi1")'>psi1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@psi-1 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2psi1">The TORSION action with label <b>psi1</b> calculates a single scalar value</span>
<b name="eg2psi2" onclick='showPath("eg2","eg2psi2")'>psi2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@psi-2 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2psi2">The TORSION action with label <b>psi2</b> calculates a single scalar value</span>
<b name="eg2psi3" onclick='showPath("eg2","eg2psi3")'>psi3: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@psi-3 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2psi3">The TORSION action with label <b>psi3</b> calculates a single scalar value</span>
<b name="eg2psi4" onclick='showPath("eg2","eg2psi4")'>psi4: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@psi-4 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2psi4">The TORSION action with label <b>psi4</b> calculates a single scalar value</span>
<b name="eg2psi5" onclick='showPath("eg2","eg2psi5")'>psi5: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@psi-5 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2psi5">The TORSION action with label <b>psi5</b> calculates a single scalar value</span>
<b name="eg2psi6" onclick='showPath("eg2","eg2psi6")'>psi6: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@psi-6 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2psi6">The TORSION action with label <b>psi6</b> calculates a single scalar value</span>
<b name="eg2psi7" onclick='showPath("eg2","eg2psi7")'>psi7: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@psi-7 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2psi7">The TORSION action with label <b>psi7</b> calculates a single scalar value</span>
<b name="eg2psi8" onclick='showPath("eg2","eg2psi8")'>psi8: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@psi-8 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2psi8">The TORSION action with label <b>psi8</b> calculates a single scalar value</span>
<b name="eg2phi2" onclick='showPath("eg2","eg2phi2")'>phi2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@phi-2 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2phi2">The TORSION action with label <b>phi2</b> calculates a single scalar value</span>
<b name="eg2phi3" onclick='showPath("eg2","eg2phi3")'>phi3: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@phi-3 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2phi3">The TORSION action with label <b>phi3</b> calculates a single scalar value</span>
<b name="eg2phi4" onclick='showPath("eg2","eg2phi4")'>phi4: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@phi-4 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2phi4">The TORSION action with label <b>phi4</b> calculates a single scalar value</span>
<b name="eg2phi5" onclick='showPath("eg2","eg2phi5")'>phi5: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@phi-5 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2phi5">The TORSION action with label <b>phi5</b> calculates a single scalar value</span>
<b name="eg2phi6" onclick='showPath("eg2","eg2phi6")'>phi6: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@phi-6 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2phi6">The TORSION action with label <b>phi6</b> calculates a single scalar value</span>
<b name="eg2phi7" onclick='showPath("eg2","eg2phi7")'>phi7: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@phi-7 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2phi7">The TORSION action with label <b>phi7</b> calculates a single scalar value</span>
<b name="eg2phi8" onclick='showPath("eg2","eg2phi8")'>phi8: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@phi-8 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2phi8">The TORSION action with label <b>phi8</b> calculates a single scalar value</span>
<b name="eg2phi9" onclick='showPath("eg2","eg2phi9")'>phi9: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=@phi-9 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2phi9">The TORSION action with label <b>phi9</b> calculates a single scalar value</span>
<b name="eg2ahc" onclick='showPath("eg2","eg2ahc")'>ahc: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_a_l_p_h_a_r_m_s_d.html" style="color:green">ALPHARMSD</a> <div class="tooltip">RESIDUES<div class="right">this command is used to specify the set of residues that could conceivably form part
of the secondary structure. <i></i></div></div>=all <div class="tooltip">TYPE<div class="right"><b>compulsory keyword ( default=DRMSD )</b>
the manner in which RMSD alignment is performed. <i></i></div></div>=OPTIMAL <div class="tooltip">LESS_THAN<div class="right">calculate the number of variables less than a certain target value. <i></i></div></div>={RATIONAL R_0=0.12}  <span style="display:none;" id="eg2ahc">The ALPHARMSD action with label <b>ahc</b> calculates a single scalar value</span>
<span style="color:blue"># Bulky Trp residue dihedral</span>
<b name="eg2dihtrp_cacb" onclick='showPath("eg2","eg2dihtrp_cacb")'>dihtrp_cacb: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=67,47,49,52 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2dihtrp_cacb">The TORSION action with label <b>dihtrp_cacb</b> calculates a single scalar value</span>
<b name="eg2dihtrp_cbcg" onclick='showPath("eg2","eg2dihtrp_cbcg")'>dihtrp_cbcg: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=47,49,52,53 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2dihtrp_cbcg">The TORSION action with label <b>dihtrp_cbcg</b> calculates a single scalar value</span>
<b name="eg2protein-ca" onclick='showPath("eg2","eg2protein-ca")'>protein-ca: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_g_r_o_u_p.html" style="color:green">GROUP</a> <div class="tooltip">NDX_FILE<div class="right">the name of index file (gromacs syntax) <i></i></div></div>=index.ndx <div class="tooltip">NDX_GROUP<div class="right">the name of the group to be imported (gromacs syntax) - first group found is used
by default <i></i></div></div>=C-alpha <span style="display:none;" id="eg2protein-ca">The GROUP action with label <b>protein-ca</b> defines a group of atoms so that they can be referred to later in the input</span>
<b name="eg2gyr" onclick='showPath("eg2","eg2gyr")'>gyr: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_g_y_r_a_t_i_o_n.html" style="color:green">GYRATION</a> <div class="tooltip">TYPE<div class="right"><b>compulsory keyword ( default=RADIUS )</b>
The type of calculation relative to the Gyration Tensor you want to perform <i></i></div></div>=RADIUS <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the Gyration Tensor for. <i></i></div></div>=<b name="eg2protein-ca">protein-ca</b> <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2gyr">The GYRATION action with label <b>gyr</b> calculates a single scalar value</span>
<span style="color:blue"># PBMetaD</span>
<b name="eg2pb" onclick='showPath("eg2","eg2pb")'>pb: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_p_b_m_e_t_a_d.html" style="color:green">PBMETAD</a> ...
   
   <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg2phi2">phi2</b>,<b name="eg2phi3">phi3</b>,<b name="eg2phi4">phi4</b>,<b name="eg2phi5">phi5</b>,<b name="eg2phi6">phi6</b>,<b name="eg2phi7">phi7</b>,<b name="eg2phi8">phi8</b>,<b name="eg2phi9">phi9</b>,<b name="eg2psi1">psi1</b>,<b name="eg2psi2">psi2</b>,<b name="eg2psi3">psi3</b>,<b name="eg2psi4">psi4</b>,<b name="eg2psi5">psi5</b>,<b name="eg2psi6">psi6</b>,<b name="eg2psi7">psi7</b>,<b name="eg2psi8">psi8</b>,<b name="eg2dihtrp_cacb">dihtrp_cacb</b>,<b name="eg2dihtrp_cbcg">dihtrp_cbcg</b>,<b name="eg2ahc">ahc.lessthan</b> 
   <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.01 
   <div class="tooltip">HEIGHT<div class="right">the height of the Gaussian hills, one for all biases. <i></i></div></div>=0.5 
   <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition, one for all biases <i></i></div></div>=400 
   <div class="tooltip">BIASFACTOR<div class="right">use well tempered metadynamics with this bias factor, one for all biases. <i></i></div></div>=20 
   <div class="tooltip">GRID_MIN<div class="right">the lower bounds for the grid <i></i></div></div>=-pi,-pi,-pi,-pi,-pi,-pi,-pi,-pi,-pi,-pi,-pi,-pi,-pi,-pi,-pi,-pi,-pi,-pi,0 
   <div class="tooltip">GRID_MAX<div class="right">the upper bounds for the grid <i></i></div></div>=pi,pi,pi,pi,pi,pi,pi,pi,pi,pi,pi,pi,pi,pi,pi,pi,pi,pi,5 
   <div class="tooltip">GRID_WSTRIDE<div class="right">frequency for dumping the grid <i></i></div></div>=5000 
   <div class="tooltip">WALKERS_MPI<div class="right">( default=off ) Switch on MPI version of multiple walkers - not compatible with WALKERS_*
options other than WALKERS_DIR <i></i></div></div> 
...<span style="display:none;" id="eg2pb">The PBMETAD action with label <b>pb</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg2phi2">phi2</b>,<b name="eg2phi3">phi3</b>,<b name="eg2phi4">phi4</b>,<b name="eg2phi5">phi5</b>,<b name="eg2phi6">phi6</b>,<b name="eg2phi7">phi7</b>,<b name="eg2phi8">phi8</b>,<b name="eg2phi9">phi9</b>,<b name="eg2psi1">psi1</b>,<b name="eg2psi2">psi2</b>,<b name="eg2psi3">psi3</b>,<b name="eg2psi4">psi4</b>,<b name="eg2psi5">psi5</b>,<b name="eg2psi6">psi6</b>,<b name="eg2psi7">psi7</b>,<b name="eg2psi8">psi8</b>,<b name="eg2dihtrp_cacb">dihtrp_cacb</b>,<b name="eg2dihtrp_cbcg">dihtrp_cbcg</b>,<b name="eg2ahc">ahc.lessthan</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=200 <span style="display:none;" id="eg2">The PRINT action with label <b></b></span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=ENERGY <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg2bias">bias.bias</b>,<b name="eg2pb">pb.bias</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=200 <span style="display:none;" id="eg2">The PRINT action with label <b></b></span>
</pre>
<p>In this case we are running a multiple-replica simulation where the sampling is used to parallelize the Metadynamics time-dependent potential through the use of multiple walkers.</p>
<pre class="fragment">mpiexec -np 14 gmx_mpi mdrun -s topolnew -multi 14 -plumed plumed-eef1-pbmetad.dat -table table.xvg -tablep table.xvg &gt;&amp; log.out &amp;
</pre><h1><a class="anchor" id="isdb-1-m_m"></a>
Metadynamics Metainference</h1>
<p>The former simulations should provide a converged (check for this) ensemble for the peptide. As shown in <a class="el" href="citelist.html#CITEREF_Lohr:2017gc">[74]</a> the agreement with the multiple available NMR experimental data is not perfect. In order to generate an ensemble compatible with most of the available experimental data it is possible to include them in the simulation using <a class="el" href="_m_e_t_a_i_n_f_e_r_e_n_c_e.html">METAINFERENCE</a> . To do so the forward models for the data sets should be defined in the input file. In this case we have backbone chemical shifts, <a class="el" href="_c_s2_b_a_c_k_b_o_n_e.html">CS2BACKBONE</a> ; residual dipolar couplings for two bonds, <a class="el" href="_r_d_c.html">RDC</a> ; and J-couplings for multiple atoms, <a class="el" href="_j_c_o_u_p_l_i_n_g.html">JCOUPLING</a>. Once the forward models are defined for the data sets, the calculated data together with the corresponding experimental values can be used to calculate the metainference score. The metainference score is additive so it can be split into multiple <a class="el" href="_m_e_t_a_i_n_f_e_r_e_n_c_e.html">METAINFERENCE</a> entries. In this case we are using two metainference entries for the two sets of RDCs because these are compared with the experimental data modulo a constant that should be unique each data set. Then we use one metainference for all the jcouplings and another one for the chemical shifts.</p>

PRINT ARG=jhanst.*,jhahnst.*,jw5ccyst.*,jw5ncyst.* STRIDE=2000 FILE=ST.J<p>As for the former case we are running a multiple-replica simulation where in addition to multiple-walker metadynamics we are also coupling the replicas through Metainference. The use of multiple-walkers metadynamics is here key in order to have the same bias defined for all the replicas. This allows us to calculate a weighted average of the experimental observables where the weights are defined univocally from the bias <a class="el" href="citelist.html#CITEREF_Bonomi:2016ge">[19]</a> .</p>
<pre class="fragment">mpiexec -np 14 gmx_mpi mdrun -s topolnew -multi 14 -plumed plumed-eef1-pbmetad-m_m.dat -table table.xvg -tablep table.xvg &gt;&amp; log.out &amp;
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_add_mod.html">Additional Modules</a></li><li class="navelem"><a class="el" href="_i_s_d_b.html">PLUMED-ISDB</a></li><li class="navelem"><a class="el" href="_i_s_d_b_tutorial.html">Tutorials</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
